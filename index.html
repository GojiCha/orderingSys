<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goji Cha - Sip. Smile. Smash the Day</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for the Gojira/Retro theme -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // NEW LOGO COLORS
                        'app-bg': '#E7F2E2', // Keeping a light background but changing accents
                        'logo-gray': '#798799', // Main monster body color (used for background)
                        'logo-purple': '#892F7F', // Dorsal fin color (used for dark text/accents)
                        'logo-green': '#81EE4A', // Breath/Matcha highlight color
                        
                        // Mapped old colors to new ones
                        'text-dark': '#892F7F',      // Deep Purple for text/main buttons
                        'card-bg': '#F7F4EB',        // Off-white for cards (Good contrast)
                        'button-main': '#798799',    // Main Gray/Blue for unselected buttons/accents
                        'matcha-highlight': '#85c047', // Vivid Logo Green
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom styles for blocky, retro look */
        .quantity-btn {
            @apply p-2 rounded-none text-lg font-bold transition-colors duration-200 bg-text-dark text-white hover:bg-matcha-highlight focus:outline-none focus:ring-2 focus:ring-matcha-highlight;
            width: 32px;
            height: 32px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #798799; /* Use the logo gray for buttons */
        }
        .quantity-btn:hover {
            background-color: #81EE4A; /* Hover to bright logo green */
            color: #892F7F; /* Change text color to dark purple on hover for visibility */
        }
        .quantity-input {
            @apply text-center bg-card-bg border border-text-dark rounded-none mx-1 text-text-dark font-medium;
            width: 40px;
            height: 32px;
        }
        /* Style for the main confirm button */
        #confirm-button {
             /* Use the main purple accent for the button when enabled */
            background-color: #892F7F; 
            border-color: #798799;
            box-shadow: 4px 4px 0 #798799; /* Shadow in the monster gray color */
        }
        #confirm-button:hover:not(:disabled) {
            background-color: #81EE4A; /* Hover to bright logo green */
            color: #892F7F; /* Text to deep purple */
            box-shadow: 4px 4px 0 #892F7F; /* Shadow to deep purple */
        }
    </style>
</head>
<body class="bg-logo-gray min-h-screen p-4 font-sans flex justify-center text-text-dark">

    <div class="w-full max-w-lg bg-card-bg shadow-2xl border-4 border-text-dark rounded-lg overflow-hidden">
        
        <!-- Header - Themed with Poster Art -->
        <!-- NOTE: The image URL is '501873.jpg'. Ensure this file is uploaded alongside the index.html file. -->
        <header class="h-40 relative bg-cover bg-center border-b-4 border-text-dark" 
                style="background-image: url('https://github.com/GojiCha/orderingSys/blob/main/501873.jpg'); background-position: top center;">
            <div class="absolute inset-0 bg-text-dark opacity-30"></div>
            <!-- Header content removed as requested to let the logo dominate -->
            <div class="absolute inset-0"></div>
        </header>

        <div class="p-6 md:p-8">
            
            <!-- Information Banner: BSN Staff Only -->
            <div class="text-center p-3 mb-6 border-4 border-logo-purple bg-logo-green text-logo-purple font-extrabold text-lg rounded-none shadow-md">
                FOR WISMA BSN ONLY
            </div>

            <!-- Menu Section -->
            <main id="menu-container" class="space-y-4 mb-6">
                <!-- Menu items will be injected here by JavaScript -->
            </main>
            
            <!-- Customer Name Input -->
            <div class="mb-6">
                <label for="customer-name" class="block text-xl font-bold mb-2 text-text-dark">üë§ Your Name</label>
                <input type="text" id="customer-name"
                       class="w-full p-3 bg-card-bg border-2 border-text-dark rounded-none focus:ring-matcha-highlight focus:border-matcha-highlight"
                       placeholder="Enter your name for pickup" required>
            </div>
            <!-- End Customer Name Input -->

            <!-- Notes Input Section -->
            <div class="mb-8">
                <label for="order-notes" class="block text-xl font-bold mb-2 text-text-dark">üìù Add Notes</label>
                <p class="text-sm text-gray-700 mb-2">E.g., "Less ice" or "I'll be there in 5 mins."</p>
                <textarea id="order-notes"
                          class="w-full p-3 h-20 bg-card-bg border-2 border-text-dark rounded-none focus:ring-matcha-highlight focus:border-matcha-highlight resize-none"
                          placeholder="Enter specific instructions here..."></textarea>
            </div>
            <!-- End Notes Input -->

            <!-- Order Summary & Confirmation Button -->
            <div class="border-t-4 border-text-dark pt-6">
                
                <!-- Pickup Info -->
                <div class="text-center p-3 mb-6 border-4 border-logo-purple bg-logo-green text-logo-purple font-extrabold text-lg rounded-none shadow-md">
                    <span>üìç Pickup Location:</span>
                    <span class="text-text-dark font-extrabold">LEVEL 17</span>
                </div>

                <!-- Total Price -->
                <div class="flex justify-between items-center text-xl font-bold text-text-dark mb-4">
                    <span>Total Price:</span>
                    <span id="total-price">RM 0.00</span>
                </div>

                <button onclick="confirmOrder()"
                    id="confirm-button"
                    disabled
                    class="w-full py-4 text-white font-bold rounded-none border-2 border-text-dark transition-all duration-200 shadow-[4px_4px_0_#2F2E2A]
                           bg-button-main hover:bg-matcha-highlight hover:shadow-[4px_4px_0_#4CAF50] disabled:bg-gray-400 disabled:shadow-[4px_4px_0_#9CA3AF]">
                    Confirm Order
                </button>
                
                <p id="whatsapp-message" class="text-center text-sm text-button-main font-semibold mt-2 hidden">
                    ERROR: Please set the WhatsApp number in the script.
                </p>
            </div>
        </div>
        
    </div>

    <script>
        // --- CONFIGURATION ---
        // IMPORTANT: Change this to your WhatsApp number, including the country code (e.g., 60123456789 for Malaysia)
        const WHATSAPP_NUMBER = "60126915105"; 
        
        // Define your menu items
        const menu = [
            { id: 1, name: "Matcha Latte", price: 10.00, desc: "Classic iced pure matcha with Oatside Milk + sweetened/unsweetened.", imageUrl: "https://placehold.co/80x80/4CAF50/FFFFFF?text=LATTE" },
            { id: 2, name: "Strawberry Matcha", price: 13.00, desc: "Sweet strawberry puree layered with cool matcha and Oatside milk.", imageUrl: "https://placehold.co/80x80/D32F2F/4CAF50?text=STRAW" },
            { id: 3, name: "Earl Grey Matcha", price: 11.00, desc: "Creamy matcha layered with Earl Grey tea & Oatside milk.", imageUrl: "https://placehold.co/80x80/A1887F/4CAF50?text=EARL" },
            { id: 4, name: "Lemonade Matcha", price: 12.00, desc: "Tangy fresh sparkling lemonade topped with vibrant matcha.", imageUrl: "https://placehold.co/80x80/FFC107/4CAF50?text=LEMON" },
        ];
        
        // State to track item quantities
        const orderQuantities = {}; 

        // --- CORE FUNCTIONS ---

        /**
         * Renders the menu items to the container.
         */
        function renderMenu() {
            const container = document.getElementById('menu-container');
            container.innerHTML = menu.map(item => `
                <div class="flex items-start p-3 bg-card-bg border-2 border-text-dark">
                    
                    <!-- Image -->
                    <img src="${item.imageUrl}" 
                         onerror="this.onerror=null;this.src='https://placehold.co/80x80/2F2E2A/4CAF50?text=üçµ'"
                         alt="${item.name}" 
                         class="w-20 h-20 object-cover rounded-none mr-4 flex-shrink-0 border-2 border-text-dark">

                    <!-- Text Details and Quantity Controls Container -->
                    <div class="flex-grow min-w-0 flex flex-col justify-between">
                        
                        <!-- Details -->
                        <div class="mb-2">
                            <h3 class="text-lg font-semibold text-text-dark">${item.name}</h3>
                            <p class="text-sm text-gray-700">${item.desc}</p>
                        </div>

                        <!-- Price and Quantity Controls -->
                        <div class="flex justify-between items-center mt-1">
                            <p class="text-xl font-bold text-matcha-highlight">RM ${item.price.toFixed(2)}</p>
                            
                            <!-- Quantity Controls -->
                            <div class="flex items-center space-x-1">
                                <button class="quantity-btn" 
                                        onclick="updateQuantity(${item.id}, -1)">
                                    &minus;
                                </button>
                                
                                <input type="number" 
                                        id="qty-${item.id}" 
                                        value="0" 
                                        min="0" 
                                        readonly 
                                        class="quantity-input">
                                        
                                <button class="quantity-btn" 
                                        onclick="updateQuantity(${item.id}, 1)">
                                    &plus;
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            // Initialize quantities to 0
            menu.forEach(item => orderQuantities[item.id] = 0);
            updateSummary();
        }

        /**
         * Updates the quantity of a specific item.
         */
        function updateQuantity(itemId, change) {
            let currentQty = orderQuantities[itemId] || 0;
            let newQty = currentQty + change;
            
            if (newQty < 0) {
                newQty = 0;
            }
            
            orderQuantities[itemId] = newQty;
            document.getElementById(`qty-${itemId}`).value = newQty;
            
            updateSummary();
        }

        /**
         * Calculates the total cost and updates the UI and button state.
         */
        function updateSummary() {
            let totalCost = 0;
            let totalItems = 0; // Still need totalItems to manage the confirm button state

            menu.forEach(item => {
                const qty = orderQuantities[item.id] || 0;
                totalCost += qty * item.price;
                totalItems += qty;
            });

            // Update the display with total price
            document.getElementById('total-price').textContent = `RM ${totalCost.toFixed(2)}`;

            // Enable/disable the confirm button
            const confirmBtn = document.getElementById('confirm-button');
            confirmBtn.disabled = totalItems === 0; // Button is disabled if no items are selected
        }

        /**
         * Generates the order message and redirects to WhatsApp.
         */
        function confirmOrder() {
            // Check for WhatsApp number configuration
            if (WHATSAPP_NUMBER === "60123456789") {
                document.getElementById('whatsapp-message').classList.remove('hidden');
                console.error("Please update the WHATSAPP_NUMBER in the script before deploying.");
                return;
            }
            
            // Get user input
            const customerName = document.getElementById('customer-name').value.trim();
            const orderNotes = document.getElementById('order-notes').value.trim();
            
            // Enforce name input (soft requirement)
            if (!customerName) {
                // Using a custom modal style error message instead of alert()
                document.getElementById('confirm-button').classList.add('animate-pulse');
                setTimeout(() => document.getElementById('confirm-button').classList.remove('animate-pulse'), 1000);
                
                // Note: Since we can't use alert, we'll just put focus on the required field 
                // and rely on the required attribute in the HTML for basic browser validation.
                document.getElementById('customer-name').focus(); 
                return;
            }

            const timestamp = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            
            const orderedItems = [];
            let totalCost = 0;
            
            menu.forEach(item => {
                const qty = orderQuantities[item.id];
                if (qty > 0) {
                    const lineTotal = qty * item.price;
                    orderedItems.push({
                        name: item.name,
                        qty: qty,
                        price: item.price,
                        total: lineTotal
                    });
                    totalCost += lineTotal;
                }
            });

            if (orderedItems.length === 0) {
                console.error("No items selected.");
                return;
            }

            // 2. Construct the message string
            let message = `‚ò¢Ô∏è NEW ORDER (${timestamp}) from Gojira Pop-up! ‚ò¢Ô∏è\n`;
            message += `CUSTOMER: ${customerName}\n`;
            message += `PICKUP: Level 17 (BSN Staff)\n\n`; // Added pickup info
            message += "--- Customer Order ---\n";
            
            orderedItems.forEach(item => {
                message += `${item.qty}x ${item.name} (RM ${(item.qty * item.price).toFixed(2)})\n`;
            });
            
            message += `---------------------------\n`;
            message += `Total Due: RM ${totalCost.toFixed(2)}\n\n`;

            // Add notes if present
            if (orderNotes) {
                message += `*** SPECIAL NOTES: ***\n`;
                message += `${orderNotes}\n\n`;
            }
            
            message += "Please reply to confirm availability and pickup time.";
            
            console.log("Generated Message:", message);
            
            // 3. Encode the message and build the URL
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;
            
            // 4. Open WhatsApp
            window.open(whatsappUrl, '_blank');
        }

        // --- INITIALIZATION ---
        window.onload = renderMenu;

    </script>
</body>
</html>
